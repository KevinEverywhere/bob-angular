"use strict";angular.module("bobApp.youtube",["bobApp"]).service("YouTubeService",["$rootScope","$http","$q","$state","$window",function($rootScope,$http,$q,$state,$window){var _service={activePlayer:null,feedStart:"https://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20youtube.search%20where%20query%3D%22",feedEnd:"%22&format=json&diagnostics=true&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys&callback=JSON_CALLBACK",query:["query","results","video"],returnObj:null,youTubeController:null,startMedia:function(which,obj){if(which){var me=obj;me.player&&"video"!=$state.$current?me.player.loadVideoById(which):me.player=new $window.YT.Player("ytplayer",{height:_service.activePlayer.height,width:_service.activePlayer.width,videoId:which+"?autoplay=1&html5=1&autostart=1&enablejsapi=1&",events:{onReady:me.onPlayerReady,onStateChange:me.onPlayerStateChange}}),$window.Player=me.player}else $window.Player="Connected for unit testing."},onPlayerReady:function(evt){$window.player=evt.target},onPlayerStateChange:function(){2==_service.player.getPlayerState()&&"videofeed.videofeed.index"==$state.$current.name&&$rootScope.$broadcast("incrementCurrentVideo")}};return _service}]).controller("ThreeYouTubeController",["$window","$scope","$rootScope","$state","$stateParams","threeCSSService","$timeout","YouTubeSearchService","YouTubeService",function($window,$scope,$rootScope,$state,$stateParams,threeCSSService,$timeout,YouTubeSearchService,YouTubeService){$scope.name="ThreeYouTubeController",$scope._position={z:20},$scope._rotation={x:0,y:threeCSSService.radianCalculator(200),z:threeCSSService.radianCalculator(180)},$scope.activeAnimations=["animate"],$scope.activeParams={},$scope.count=0,$scope._dir=-1,$scope.incr=.01,$scope.currentRotate=199,$scope.maxRotate=200,$scope.minRotate=160,$scope.control=this,$scope.startMedia=function(which){which?(YouTubeService.activePlayer={height:$scope._height,width:$scope._width},YouTubeService.startMedia(which,YouTubeService)):YouTubeService.startMedia(!1,YouTubeService)},$scope.init=function(elem,_content,_context){if(elem){if(!this.isInited){YouTubeService.youTubeController=this,$scope.youtubeid=$rootScope.youtubeid?$rootScope.youtubeid:$scope.youtubeid||$stateParams.youtubeid||"afBm0Dpfj_k",threeCSSService.init(elem,$scope,_content,_context),this.isInited=!0;try{render();try{$scope.startMedia($scope.youtubeid)}catch(oops){$timeout(function(){$scope.startMedia($scope.youtubeid)},1e3)}}catch(oops){console.log("youtube.js rendering bypassed for unit tests.")}}}else $scope.startMedia(!1)},$scope.animate=function(){$scope.currentRotate+=$scope._dir*$scope.incr,$scope.currentRotate<$scope.maxRotate?$scope.currentRotate<$scope.minRotate&&($scope._dir=-$scope._dir,$scope.currentRotate+=$scope._dir):($scope._dir=-$scope._dir,$scope.currentRotate+=$scope._dir),$scope.css3DObject.rotation.y=threeCSSService.radianCalculator($scope.currentRotate),$scope.css3DObject.position.z=$scope.css3DObject.position.z+$scope._dir*$scope.incr*10,$scope.renderer.render($scope.scene,$scope.camera)};var render=function(){$scope.renderer.render($scope.scene,$scope.camera),threeCSSService.render($scope)}}]);